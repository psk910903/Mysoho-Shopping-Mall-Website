
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="//code.jquery.com/jquery-3.3.1.min.js"></script>
  <title>Document</title>
  <!--  선택 삭제기능, 검색기능, -->
  <style>

      * {
        margin: 0;
        padding: 0;
      }
      .contentHeader {
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 60px;
        padding: 0 25px;
        background-color: white;
        border: 1px solid #dee2e6;
        font-size: 25px;
        font-weight: bold;
      }
      .navHeader{
      align-items: center;
      height: 60px;
      padding: 0 10px;
      border-bottom: 1px solid #dee2e6;
      color: white;
      font-size: 25px;
      margin-bottom: 20px
      }
      #wrap {
        display: flex;
        min-height: 940px;
        background-color: #f8f9fa ;
      }
      .admin-navBar {
        min-width: 200px;
        padding: 0;
        background-color: #333;

      }
      .admin-navBar div {
        display: flex;
      }

      .admin-navBar a {
        margin: 0 15px;
        text-decoration: none;
        padding: 15px 0;
        width: 100%;
        border-bottom: 1px solid #949ca6;
        color: white;
      }
      .admin-navBar a:hover {
      font-weight: bold;
      color: white;
      }
      .head-title {
        display: flex;
        align-items: center;
      }
      .logout-btn {
        margin-right: 50px;
        padding: 10px 20px;
        font-weight: bold;
        font-size: 18px;
      }
      .content {
        padding: 20px;
        width: 100%;
      }
      .countItem {
        display: flex;
        justify-content: space-between;
        padding : 5px 20px;
      }
      .listCount{
         display: flex;
         align-items: flex-end;
      }
      .productImg{
        max-height: 70px;
      }
           .page-link {
          color: #000;
          background-color: #fff;
          border: 1px solid #ccc;
          }

        .page-item.active .page-link {
         z-index: 1;
         color: #555;
         font-weight:bold;
         background-color: #fff;
         border-color: #ccc;

        }

        .page-link:focus, .page-link:hover {
          color: #000;
          background-color: #fafafa;
          border-color: #ccc;
        }
        select{
            border: 1px solid #dee2e6;
        }
        .contentWrap{
            background-color: white;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid #dee2e6;
        }
        .contentHeader{
         background-color: white;
        }
        </style>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-iYQeCzEYFbKjA/T2uDLTpkwGzCiq6soy8tYaI1GyVh/UjpbCx/TYkiZhlZB6+fzT" crossorigin="anonymous">
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.min.js" integrity="sha384-7VPbUDkoPSGFnVtYi0QogXtr74QeVeeIs99Qfg5YCF+TidwNdjvaKZX19NZ/e6oz" crossorigin="anonymous"></script>
</head>


<div id="wrap">
  <div th:replace="/fragments/nav.html :: fragment-adminNav"></div>

  <script src="https://code.jquery.com/jquery-3.6.3.min.js"></script>
  <div id="contentWrap" style="width:100%">
    <div class="contentHeader" style="width:100%">
      <div>회원관리</div>
      <div>
        <a type="button" class="btn btn-secondary">로그아웃</a>
      </div>
    </div>
    <div class="content" style="width:100%">
      <!--    회원 목록테이블 구성-->
      <form action="/admin/member/list" method="get" class="form">
        <div class="contentWrap">
          <input type="hidden" name="page" value="0">
          <div>
            <table class="table table-bordered ">
              <tr>
                <th style="text-align: center;" class="pt-2">회원등급</th>
                <td>
                  <select class="rating" name="findByType1" class="form-select">
                    <option value="all" selected="selected">모든회원</option>
                    <option value="VIP">VIP</option>
                    <option value="일반회원">일반회원</option>
                  </select>
                </td>
              </tr>
              <tr>
                <th style="text-align: center;" class="pt-4">검색조건</th>
                <td class="pt-3">
                  <div class="input-group mb-3 ">
                    <select class="rating " name="findByType2">
                      <option value="all" selected="selected">전체보기</option>
                      <option value="이름">이름</option>
                      <option value="아이디">아이디</option>
                      <input type="text" class="form-control" name="keyword" aria-label="Recipient's username" aria-describedby="button-addon2">
                      <button class="btn btn-outline-secondary" type="submit" >검색</button>
                    </select>
                  </div>

                </td>

              </tr>
            </table>

          </div>
        </div>
        <div class="contentWrap">
          <div >
            <span>총 회원수 : </span>
            <strong th:text="${ listCount }+'명'">5</strong>
          </div>
          <table class="table table-bordered " style="text-align: center;">

            <tr>
              <th><input type='checkbox'
                         name='RowCheck'
                         onclick='selectAll(this)'/></th>
              <th>번호</th>
              <th>이름</th>
              <th>아이디</th>
              <th>연락처</th>
              <th>이메일</th>
              <th>가입일자</th>
              <th>상세정보</th>
            </tr>
            <tbody id="tbody">
            <tr th:each="dto:${ list }">
              <th class="pt-3"><input type="checkbox" name="RowCheck" th:value="${ dto.memberNo }" /></th>
              <td class="pt-3" th:text="${ dto.memberNo }">번호</td>
              <td class="pt-3" th:text="${ dto.memberName }">이름</td>
              <td class="pt-3" th:text="${ dto.memberId }">아이디</td>
              <td class="pt-3" th:text="${ dto.memberPhone }">폰번</td>
              <td class="pt-3" th:text="${ dto.memberEmail }">이멜</td>
              <td class="pt-3" th:text="${ dto.memberJoinDatetime }">가입날짜</td>
              <td><a th:href="@{content/{id}(id=${dto.memberNo})}" class="btn btn-outline-secondary" type="button"> 보기</a></td>

            </tr>
            </tbody>
          </table>
          <input class="btn btn-danger" type="button" onclick="deleteValue()";  value="선택삭제"/>
        </div>
        <script>
     function deleteValue(){

      var memberNo = "";
     $( "input[name='RowCheck']:checked" ).each (function (){
     memberNo = memberNo + $(this).val()+"," ;
     });
    if(memberNo == ""){
     alert("삭제할 대상을 선택하세요.");
     return false;
     }
     $.ajax({
            url : '/admin/member/delete/check',
            type : 'POST',
            traditional : true,
            data : {
              memberNo : memberNo
            },
            success: function(jdata){
              if(jdata = 1){
                alert("삭제 성공");
                location.replace("/admin/member/")
              }
              else{
                alert("삭제 실패")
              }
            }
        });
    }
    </script>
        <div class="wrap">
          <div class="container"> <!-- 페이지 시작 -->
            <div th:if="${!list.isEmpty()}">
              <ul class="pagination justify-content-center">
                <li class="page-item" th:classappend="${!list.hasPrevious} ? 'disabled'"> <!-- 이전 버튼 시작 -->
                  <th:block th:if="${#strings.equals(keyword, '')} and ${totalPage} == 1">
                    <a class="page-link" th:href="|/admin/member/list?page=${list.number-1}|">
                      <span>이전</span>
                    </a>
                  </th:block>
                  <th:block th:unless="${#strings.equals(keyword, '')} and ${totalPage} == 1">
                    <a class="page-link" th:href="|/admin/member/list?page=${list.number-1}&findByType1=${findByType1}&findByType2=${findByType2}&keyword=${keyword}|">
                      <span>이전</span>
                    </a>
                  </th:block>
                </li> <!-- 이전 버튼 끝 -->
                <li th:each="page: ${pageList}"
                    th:classappend="${page == list.number} ? 'active'"
                    class="page-item"> <!-- 숫자 페이지 버튼 시작 -->
                  <th:block th:if="${#strings.equals(keyword, '')} and ${totalPage} == 1">
                    <a th:text="${page+1}" class="page-link" th:href="|/admin/member/list?page=${page}|"></a>
                  </th:block>
                  <th:block th:unless="${#strings.equals(keyword, '')} and ${totalPage} == 1">
                    <a th:text="${page+1}" class="page-link"
                       th:href="|/admin/member/list?page=${page}&findByType1=${findByType1}&findByType2=${findByType2}&keyword=${keyword}|"></a>

                  </th:block>
                </li> <!-- 숫자 페이지 버튼 끝 -->
                <li class="page-item" th:classappend="${!list.hasNext} ? 'disabled'"> <!-- 다음 버튼 시작 -->
                  <th:block th:if="${#strings.equals(keyword, '')} and ${totalPage} == 1">
                    <a class="page-link" th:href="|/admin/member/list?page=${list.number+1}|">
                      <span>다음</span>
                    </a>
                  </th:block>
                  <th:block th:unless="${#strings.equals(keyword, '')} and ${totalPage} == 1">
                    <a class="page-link" th:href="|/admin/member/list?page=${list.number+1}&findByType1=${findByType1}&findByType2=${findByType2}&keyword=${keyword}|">
                      <span>다음</span>
                    </a>
                  </th:block>
                </li> <!-- 다음 버튼 끝 -->
              </ul>
            </div>
          </div> <!-- 페이지 끝 -->

        </div>
      </form>
    </div>
  </div>
  <!--  컨텐츠 끝-->
</div>

<!-- wrap -->

</body>
<script>
    function selectAll(selectAll) {
      const checkboxes = document.getElementsByName("RowCheck");

      checkboxes.forEach((checkbox) => {
        checkbox.checked = selectAll.checked;
      });
    }
  </script>

</html>



